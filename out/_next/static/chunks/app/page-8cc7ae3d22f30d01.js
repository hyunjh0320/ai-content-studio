(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{2530:(e,t,r)=>{Promise.resolve().then(r.bind(r,3282))},3282:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>E});var a=r(5155),n=r(2115);let s="\nYou are an elite AI Content Director with expertise in:\n- Storytelling and narrative structure (3-act, hero's journey, etc.)\n- Visual direction for AI image generation (Flux, DALL-E, Midjourney)\n- Video generation prompt engineering (Kling AI, Luma Dream Machine, Runway)\n- Voice casting and TTS direction (OpenAI TTS, ElevenLabs)\n- Animation and character consistency techniques\n\nYour job is to transform a brief project concept into a COMPLETE, production-ready content plan.\n\nCRITICAL RULES:\n1. Output ONLY valid JSON — no markdown, no explanation outside JSON\n2. Image prompts MUST be in English (AI models require English)\n3. Video prompts MUST be in English\n4. Dialogue and narration can be in the requested language\n5. Negative prompts are MANDATORY for every scene\n6. Character visual descriptions must be extremely detailed and consistent across all scenes\n7. Every scene must have: narration OR dialogue (or both)\n8. Always respect the globalConstraints — these are absolute rules\n".trim();async function l(e,t,r,a,n,s,l){try{var o,i,c,d,x;let u=await fetch("https://api.openai.com/v1/chat/completions",{method:"POST",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"},body:JSON.stringify({model:t,stream:!0,temperature:.7,max_tokens:8e3,messages:[{role:"system",content:r},{role:"user",content:a}]})});if(!u.ok){let e=await u.json().catch(()=>({error:{message:u.statusText}}));l((null==e||null==(i=e.error)?void 0:i.message)||"GPT API error ".concat(u.status));return}let m=null==(o=u.body)?void 0:o.getReader();if(!m)return void l("No response body");let p=new TextDecoder,h="";for(;;){let{done:e,value:t}=await m.read();if(e)break;for(let e of p.decode(t,{stream:!0}).split("\n").filter(e=>e.startsWith("data: "))){let t=e.slice(6).trim();if("[DONE]"!==t)try{let e=(null==(x=JSON.parse(t).choices)||null==(d=x[0])||null==(c=d.delta)?void 0:c.content)||"";e&&(h+=e,n(e))}catch(e){}}}s(h)}catch(e){l(e instanceof Error?e.message:"Network error")}}let o={"flux-kontext-pro":"black-forest-labs/flux-kontext-pro","flux-1.1-pro":"black-forest-labs/flux-1.1-pro","flux-dev":"black-forest-labs/flux-dev"},i={"fal-flux-kontext":"fal-ai/flux-pro/kontext","fal-flux-pro":"fal-ai/flux-pro/v1.1"};function c(e){return new Promise(t=>setTimeout(t,e))}async function d(e){if("replicate"===e.provider)return x(e);if("fal"===e.provider)return u(e);if("openai"===e.provider)return p(e);throw Error("Unknown provider")}async function x(e){let t=o[e.model]||"black-forest-labs/flux-kontext-pro",r=e.model.includes("kontext"),a={prompt:e.prompt,output_format:e.outputFormat||"png",width:e.width||1024,height:e.height||1024};e.referenceImageUrl&&(a[r?"image_url":"image_prompt"]=e.referenceImageUrl);let n=await fetch("https://api.replicate.com/v1/predictions",{method:"POST",headers:{Authorization:"Bearer ".concat(e.apiKey),"Content-Type":"application/json",Prefer:"wait"},body:JSON.stringify({model:t,input:a})});if(!n.ok){let e=await n.json().catch(()=>({}));throw Error((null==e?void 0:e.detail)||"Replicate error ".concat(n.status))}let s=await n.json();if("succeeded"!==s.status){var l;let t=null==(l=s.urls)?void 0:l.get;for(let r=0;r<60;r++){await c(2e3);let r=await fetch(t,{headers:{Authorization:"Bearer ".concat(e.apiKey)}});if("succeeded"===(s=await r.json()).status)break;if("failed"===s.status)throw Error(s.error||"Replicate failed")}}let i=Array.isArray(s.output)?s.output[0]:s.output;if(!i)throw Error("No output URL from Replicate");return i}async function u(e){let t=i[e.model]||"fal-ai/flux-pro/kontext",r=t.includes("kontext"),a={prompt:e.prompt,num_images:1,image_size:"square_hd",output_format:e.outputFormat||"png"};e.referenceImageUrl&&r&&(a.image_url=e.referenceImageUrl);let n=await fetch("https://queue.fal.run/".concat(t),{method:"POST",headers:{Authorization:"Key ".concat(e.apiKey),"Content-Type":"application/json"},body:JSON.stringify(a)});if(!n.ok){let e=await n.json().catch(()=>({}));throw Error((null==e?void 0:e.detail)||"FAL error ".concat(n.status))}let s=await n.json();if(!s.request_id)return m(s);for(let r=0;r<60;r++){await c(2e3);let r=await fetch("https://queue.fal.run/".concat(t,"/requests/").concat(s.request_id,"/status"),{headers:{Authorization:"Key ".concat(e.apiKey)}}),a=await r.json();if("COMPLETED"===a.status){let r=await fetch("https://queue.fal.run/".concat(t,"/requests/").concat(s.request_id),{headers:{Authorization:"Key ".concat(e.apiKey)}});return m(await r.json())}if("FAILED"===a.status)throw Error(a.error||"FAL failed")}throw Error("FAL timeout")}function m(e){var t,r,a;let n=(null==e||null==(r=e.images)||null==(t=r[0])?void 0:t.url)||(null==e||null==(a=e.image)?void 0:a.url);if(!n)throw Error("No image URL in FAL response");return n}async function p(e){var t,r;let a={model:"gpt-image-1",prompt:e.prompt,n:1,size:"1024x1024",quality:"high"},n=await fetch("https://api.openai.com/v1/images/generate",{method:"POST",headers:{Authorization:"Bearer ".concat(e.apiKey),"Content-Type":"application/json"},body:JSON.stringify(a)});if(!n.ok){let e=await n.json().catch(()=>({}));throw Error((null==e||null==(r=e.error)?void 0:r.message)||"OpenAI error ".concat(n.status))}let s=await n.json(),l=null==s||null==(t=s.data)?void 0:t[0];if(null==l?void 0:l.url)return l.url;if(null==l?void 0:l.b64_json)return"data:image/png;base64,".concat(l.b64_json);throw Error("No image in OpenAI response")}let h={"kling-1.6":{label:"Kling AI 1.6",price:"~$0.18/5s",endpoint:"fal-ai/kling-video/v1.6/standard/image-to-video",maxDuration:10},"kling-1.6-pro":{label:"Kling AI 1.6 Pro",price:"~$0.36/5s",endpoint:"fal-ai/kling-video/v1.6/pro/image-to-video",maxDuration:10,note:"최고 품질"},luma:{label:"Luma Dream Machine",price:"~$0.30/5s",endpoint:"fal-ai/luma-dream-machine/image-to-video",maxDuration:5,note:"빠름"},"wan-480p":{label:"WAN 2.1 (480p)",price:"~$0.05/5s",endpoint:"fal-ai/wan/i2v/480p",maxDuration:5,note:"가장 저렴"},minimax:{label:"Minimax Hailuo",price:"~$0.10/5s",endpoint:"fal-ai/minimax/video-01",maxDuration:6}};async function v(e){let t=h[e.model],r=t.endpoint,a={prompt:e.prompt,image_url:e.imageUrl,duration:String(Math.min(e.durationSeconds||5,t.maxDuration))};e.aspectRatio&&(a.aspect_ratio=e.aspectRatio);let n=await fetch("https://queue.fal.run/".concat(r),{method:"POST",headers:{Authorization:"Key ".concat(e.falApiKey),"Content-Type":"application/json"},body:JSON.stringify(a)});if(!n.ok){let e=await n.json().catch(()=>({}));throw Error((null==e?void 0:e.detail)||(null==e?void 0:e.message)||"FAL Video error ".concat(n.status))}let s=await n.json(),l=s.request_id;if(!l)return b(s);for(let t=0;t<150;t++){await new Promise(e=>setTimeout(e,3e3));let t=await fetch("https://queue.fal.run/".concat(r,"/requests/").concat(l,"/status"),{headers:{Authorization:"Key ".concat(e.falApiKey)}}),a=await t.json();if("COMPLETED"===a.status){let t=await fetch("https://queue.fal.run/".concat(r,"/requests/").concat(l),{headers:{Authorization:"Key ".concat(e.falApiKey)}});return b(await t.json())}if("FAILED"===a.status)throw Error(a.error||"FAL Video generation failed")}throw Error("FAL Video timeout (7.5 minutes)")}function b(e){var t,r,a,n,s;let l=(null==e||null==(t=e.video)?void 0:t.url)||(null==e||null==(a=e.videos)||null==(r=a[0])?void 0:r.url)||(null==e||null==(s=e.output)||null==(n=s.video)?void 0:n.url)||(null==e?void 0:e.url);if(!l)throw Error("No video URL in FAL response");return l}let g={alloy:{label:"Alloy",gender:"중성",character:"차분하고 균형 잡힌"},echo:{label:"Echo",gender:"남성",character:"깊고 낮은 목소리"},fable:{label:"Fable",gender:"중성",character:"밝고 이야기하는 듯한"},onyx:{label:"Onyx",gender:"남성",character:"강하고 진중한"},nova:{label:"Nova",gender:"여성",character:"활기차고 따뜻한"},shimmer:{label:"Shimmer",gender:"여성",character:"부드럽고 감성적인"}};async function f(e){if("openai"===e.provider)return j(e);if("elevenlabs"===e.provider)return y(e);throw Error("Unknown TTS provider")}async function j(e){let t=await fetch("https://api.openai.com/v1/audio/speech",{method:"POST",headers:{Authorization:"Bearer ".concat(e.apiKey),"Content-Type":"application/json"},body:JSON.stringify({model:e.model||"tts-1",input:e.text,voice:e.voice,speed:e.speed||1,response_format:e.outputFormat||"mp3"})});if(!t.ok){var r;let e=await t.json().catch(()=>({error:{message:t.statusText}}));throw Error((null==e||null==(r=e.error)?void 0:r.message)||"OpenAI TTS error ".concat(t.status))}let a=await t.blob();return URL.createObjectURL(a)}async function y(e){let t=e.elevenLabsVoiceId||"21m00Tcm4TlvDq8ikWAM",r=await fetch("https://api.elevenlabs.io/v1/text-to-speech/".concat(t),{method:"POST",headers:{"xi-api-key":e.apiKey,"Content-Type":"application/json",Accept:"audio/mpeg"},body:JSON.stringify({text:e.text,model_id:"eleven_multilingual_v2",voice_settings:{stability:.5,similarity_boost:.8,style:.3,use_speaker_boost:!0}})});if(!r.ok){let e=await r.json().catch(()=>({detail:r.statusText}));throw Error((null==e?void 0:e.detail)||"ElevenLabs error ".concat(r.status))}let a=await r.blob();return URL.createObjectURL(a)}let N=[{id:"plan",label:"기획",icon:"✦"},{id:"scenario",label:"시나리오",icon:"▤"},{id:"image",label:"이미지",icon:"◧"},{id:"video",label:"영상",icon:"▶"},{id:"voice",label:"음성",icon:"♪"},{id:"export",label:"내보내기",icon:"⬇"}],w={name:"",role:"주인공",description:"",voiceType:""};function k(e){var t;let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return null!=(t=localStorage.getItem(e))?t:r}function A(e){var t,r;let{status:n,error:s}=e,l={idle:"bg-[var(--surface-2)] text-[var(--text-muted)]",pending:"bg-yellow-900/40 text-yellow-300",running:"bg-blue-900/40 text-blue-300 animate-pulse",completed:"bg-green-900/40 text-[var(--success)]",failed:"bg-red-900/40 text-[var(--danger)]"};return(0,a.jsx)("span",{className:"text-xs px-2 py-0.5 rounded-full font-medium ".concat(null!=(t=l[n])?t:l.idle),title:s,children:null!=(r=({idle:"대기",pending:"준비",running:"생성중...",completed:"완료",failed:"실패"})[n])?r:n})}function C(e){let{children:t}=e;return(0,a.jsxs)("h2",{className:"text-lg font-bold text-white mb-4 flex items-center gap-2",children:[(0,a.jsx)("span",{className:"w-1 h-5 bg-[var(--accent)] rounded-full inline-block"}),t]})}function S(e){let{label:t,value:r,onChange:s,placeholder:l}=e,[o,i]=(0,n.useState)(!1);return(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-xs text-[var(--text-muted)] mb-1 block",children:t}),(0,a.jsxs)("div",{className:"flex gap-1",children:[(0,a.jsx)("input",{type:o?"text":"password",value:r,onChange:e=>s(e.target.value),placeholder:null!=l?l:"sk-...",className:"flex-1 text-xs px-2 py-1.5 rounded border border-[var(--border)] bg-[var(--surface-2)] text-[var(--text)] font-mono"}),(0,a.jsx)("button",{onClick:()=>i(e=>!e),className:"px-2 text-xs text-[var(--text-muted)] hover:text-white border border-[var(--border)] rounded bg-[var(--surface-2)]",children:o?"숨김":"보기"})]})]})}function E(){var e,t;let[r,o]=(0,n.useState)("plan"),[i,c]=(0,n.useState)(()=>({openai:k("acs_openai"),replicate:k("acs_replicate"),fal:k("acs_fal"),elevenlabs:k("acs_elevenlabs")})),[x,u]=(0,n.useState)(!0),[m,p]=(0,n.useState)({concept:"",genre:"animation",targetAudience:"어린이",tone:"유쾌하고 따뜻한",styleRef:"3D clay render, Pixar style",sceneCount:5,language:"ko",characters:[{...w}],constraints:[""],additionalNotes:""}),[b,j]=(0,n.useState)("gpt-4o"),[y,E]=(0,n.useState)(!1),[I,T]=(0,n.useState)(""),[O,U]=(0,n.useState)(""),[L,P]=(0,n.useState)(null),[_,D]=(0,n.useState)("replicate"),[R,F]=(0,n.useState)("flux-kontext-pro"),K={replicate:"flux-kontext-pro",fal:"fal-flux-kontext",openai:"gpt-image-1"},[q,V]=(0,n.useState)({}),[z,M]=(0,n.useState)({}),[J,B]=(0,n.useState)("kling-1.6"),[$,G]=(0,n.useState)(5),[W,Y]=(0,n.useState)({}),[H,X]=(0,n.useState)({}),[Q,Z]=(0,n.useState)("openai"),[ee,et]=(0,n.useState)({}),[er,ea]=(0,n.useState)({}),en=(0,n.useCallback)(e=>{P(t=>t?{...t,scenes:e(t.scenes)}:t)},[]);function es(e,t){c(r=>{var a;let n={...r,[e]:t};return a="acs_".concat(e),localStorage.setItem(a,t),n})}async function el(){if(!i.openai)return void U("OpenAI API Key를 입력해주세요.");if(!m.concept.trim())return void U("프로젝트 아이디어를 입력해주세요.");E(!0),T(""),U(""),P(null);let e="";await l(i.openai,b,s,function(e){let t=e.characters.map((e,t)=>"  Character ".concat(t+1,": ").concat(e.name," (").concat(e.role,") — ").concat(e.description,", Voice: ").concat(e.voiceType)).join("\n"),r=e.constraints.filter(Boolean).join(", ")||"None specified";return"\nCreate a complete AI content production plan for this project:\n\n═══════════════════════════════════════════════\nPROJECT BRIEF\n═══════════════════════════════════════════════\nConcept    : ".concat(e.concept,"\nGenre      : ").concat(e.genre,"\nAudience   : ").concat(e.targetAudience,"\nTone       : ").concat(e.tone,"\nStyle Ref  : ").concat(e.styleRef||"Cinematic, high quality","\nScene Count: ").concat(e.sceneCount,"\nLanguage   : ").concat("ko"===e.language?"Korean":"en"===e.language?"English":e.language,"\nNotes      : ").concat(e.additionalNotes||"None","\n\nCHARACTERS:\n").concat(t||"  No specific characters defined — create appropriate ones","\n\nABSOLUTE CONSTRAINTS (절대 금지):\n").concat(r,'\n═══════════════════════════════════════════════\n\nOutput a single JSON object with this EXACT structure.\nDo NOT add any text before or after the JSON.\n\n{\n  "project": {\n    "title": "creative project title",\n    "logline": "single sentence that captures the essence",\n    "genre": "').concat(e.genre,'",\n    "tone": "').concat(e.tone,'",\n    "visualStyle": "detailed visual style description for AI reference",\n    "targetAudience": "').concat(e.targetAudience,'",\n    "totalDuration": "estimated total duration (e.g., \'90 seconds\')"\n  },\n\n  "characters": [\n    {\n      "id": "char_01",\n      "name": "Character Name",\n      "role": "protagonist | supporting | narrator",\n      "description": "personality and background",\n      "visualDescription": "EXTREMELY DETAILED physical description in English for image AI: body type, face shape, eye color, hair, clothing, accessories, style, colors — be specific enough that every image looks consistent",\n      "personality": "3-5 personality traits",\n      "voice": {\n        "gender": "male | female | neutral",\n        "tone": "warm, energetic, calm, etc.",\n        "accent": "standard Korean | Seoul accent | etc.",\n        "suggestedTTSVoice": "alloy | echo | fable | onyx | nova | shimmer",\n        "voiceDescription": "how this character speaks — pace, pitch, emotion level"\n      }\n    }\n  ],\n\n  "scenario": {\n    "outline": "Full story outline in 2-4 paragraphs covering the complete narrative arc",\n    "acts": [\n      { "act": 1, "title": "Act title", "description": "What happens in this act" }\n    ]\n  },\n\n  "scenes": [\n    {\n      "id": "scene_01",\n      "title": "Scene title",\n      "act": 1,\n      "order": 1,\n      "durationSeconds": 5,\n      "setting": "Where and when this scene takes place",\n      "mood": "Emotional atmosphere of this scene",\n      "description": "Detailed description of what happens visually and narratively",\n\n      "narration": "Voice-over narration text for this scene (in ').concat("ko"===e.language?"Korean":"English",'). Write naturally for speech.",\n\n      "dialogues": [\n        {\n          "characterId": "char_01",\n          "characterName": "Character Name",\n          "line": "Dialogue line (in ').concat("ko"===e.language?"Korean":"English",')",\n          "emotion": "happy | sad | excited | calm | angry | etc.",\n          "action": "What the character is physically doing while saying this"\n        }\n      ],\n\n      "imagePrompt": {\n        "main": "Core scene description for image AI — what to show, where, who, doing what (English)",\n        "characterRef": "Reference to character visual: [character name]: [key visual identifiers from visualDescription] (English)",\n        "style": "Style modifiers: e.g., \'3D clay render, Pixar style, studio lighting, bokeh background, pastel colors, vinyl toy aesthetic, high detail\'",\n        "technical": "Camera/composition: e.g., \'medium shot, eye level, rule of thirds, soft rim lighting, shallow depth of field\'",\n        "negative": "MUST include: \'deformed, blurry, low quality, watermark, text overlay, extra limbs, ugly, distorted, bad anatomy, nsfw, [+ any constraint-specific negatives]\'",\n        "full": "COMBINE all above into ONE optimized Flux-ready prompt: [characterRef] [main] [style] [technical]. Negative: [negative]"\n      },\n\n      "videoPrompt": {\n        "motion": "How subjects/characters move in this scene (English)",\n        "camera": "Camera movement: static | slow pan left | zoom in | dolly forward | etc. (English)",\n        "atmosphere": "Lighting changes, particle effects, atmosphere (English)",\n        "negative": "no camera shake, no flash cuts, no text overlay, no watermark, [+ constraint negatives]",\n        "full": "COMPLETE video prompt for Kling AI / Luma: \'[scene description], [motion], [camera movement], [atmosphere], cinematic quality, smooth motion\' (English, under 300 chars)"\n      }\n    }\n  ],\n\n  "globalConstraints": [\n    "List every absolute rule — what must NEVER appear in any generated content",\n    "Include both content restrictions AND visual style restrictions",\n    "Include the user-specified constraints: ').concat(r,'",\n    "Add sensible defaults: no watermarks, no text overlays, no explicit content, no brand logos unless specified"\n  ],\n\n  "productionNotes": {\n    "colorPalette": ["#hex1", "#hex2", "#hex3", "palette description"],\n    "lightingStyle": "Lighting approach for visual consistency",\n    "musicMood": "Background music recommendation",\n    "editingStyle": "Editing/transition style recommendation",\n    "voiceNotes": "Overall voice direction for all characters",\n    "brandGuidelines": "Any brand/style consistency rules"\n  }\n}\n\nGenerate EXACTLY ').concat(e.sceneCount," scenes.\nMake each scene unique, visually interesting, and narratively purposeful.\nEnsure character visual descriptions are IDENTICAL across all scenes for consistency.\n").trim()}(m),t=>{T(e+=t)},e=>{try{let t=function(e){let t=e.replace(/^```json\s*/im,"").replace(/^```\s*/im,"").replace(/```\s*$/im,"").trim();try{let e=JSON.parse(t);return Array.isArray(e.scenes)&&(e.scenes=e.scenes.map((e,t)=>({...e,order:"number"==typeof e.order?e.order:t+1,generatedImageUrl:void 0,generatedVideoUrl:void 0,generatedNarrationUrl:void 0}))),e}catch(e){throw Error("AI 응답을 JSON으로 파싱할 수 없습니다. 다시 시도해주세요.")}}(e);P(t),o("scenario")}catch(e){U(e instanceof Error?e.message:"파싱 오류")}E(!1)},e=>{U(e),E(!1)})}function eo(e,t,r){p(a=>{let n=[...a.characters];return n[e]={...n[e],[t]:r},{...a,characters:n}})}async function ei(e){let t="openai"===_?i.openai:"replicate"===_?i.replicate:i.fal;if(!t)return void alert("".concat(_," API Key를 입력해주세요."));V(t=>({...t,[e.id]:"running"})),M(t=>({...t,[e.id]:""}));let r={provider:_,model:R,apiKey:t,prompt:e.imagePrompt.full||e.imagePrompt.main,negativePrompt:e.imagePrompt.negative};try{let t=await d(r);en(r=>r.map(r=>r.id===e.id?{...r,generatedImageUrl:t}:r)),V(t=>({...t,[e.id]:"completed"}))}catch(r){let t=r instanceof Error?r.message:"오류";V(t=>({...t,[e.id]:"failed"})),M(r=>({...r,[e.id]:t}))}}async function ec(){if(L)for(let e of L.scenes)await ei(e)}async function ed(e){if(!i.fal)return void alert("FAL API Key를 입력해주세요.");if(!e.generatedImageUrl)return void alert("먼저 이미지를 생성해주세요. (이미지가 시작 프레임으로 사용됩니다)");Y(t=>({...t,[e.id]:"running"})),X(t=>({...t,[e.id]:""}));try{let t=await v({falApiKey:i.fal,model:J,prompt:e.videoPrompt.full||e.videoPrompt.motion,imageUrl:e.generatedImageUrl,durationSeconds:$});en(r=>r.map(r=>r.id===e.id?{...r,generatedVideoUrl:t}:r)),Y(t=>({...t,[e.id]:"completed"}))}catch(r){let t=r instanceof Error?r.message:"오류";Y(t=>({...t,[e.id]:"failed"})),X(r=>({...r,[e.id]:t}))}}async function ex(e){if(!e.narration.trim())return;let t="openai"===Q?i.openai:i.elevenlabs;if(!t)return void alert("".concat(Q," API Key를 입력해주세요."));et(t=>({...t,[e.id]:"running"}));try{let r={provider:Q,apiKey:t,text:e.narration,voice:"alloy"},a=await f(r);en(t=>t.map(t=>t.id===e.id?{...t,generatedNarrationUrl:a}:t)),et(t=>({...t,[e.id]:"completed"}))}catch(t){et(t=>({...t,[e.id]:"failed"}))}}async function eu(e,t){let r=e.dialogues[t];if(!(null==r?void 0:r.line.trim()))return;let a="openai"===Q?i.openai:i.elevenlabs;if(!a)return void alert("".concat(Q," API Key를 입력해주세요."));let n="".concat(e.id,"_").concat(t);ea(e=>({...e,[n]:"running"}));try{let s={provider:Q,apiKey:a,text:r.line,voice:function(e,t){let r=null==L?void 0:L.characters.find(e=>e.id===t);return(null==r?void 0:r.voice.suggestedTTSVoice)||"alloy"}(0,r.characterId)},l=await f(s);en(r=>r.map(r=>{if(r.id!==e.id)return r;let a=r.dialogues.map((e,r)=>r===t?{...e,audioUrl:l}:e);return{...r,dialogues:a}})),ea(e=>({...e,[n]:"completed"}))}catch(e){ea(e=>({...e,[n]:"failed"}))}}let em=null!=(e=null==L?void 0:L.scenes.filter(e=>e.generatedImageUrl).length)?e:0,ep=null!=(t=null==L?void 0:L.scenes.filter(e=>e.generatedVideoUrl).length)?t:0;return(0,a.jsxs)("div",{className:"min-h-screen flex flex-col",style:{background:"var(--bg)"},children:[(0,a.jsxs)("header",{className:"flex items-center justify-between px-6 py-3 border-b border-[var(--border)]",style:{background:"var(--surface)"},children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("span",{className:"text-2xl",children:"✦"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-base font-bold text-white",children:"AI Content Studio"}),(0,a.jsx)("p",{className:"text-xs text-[var(--text-muted)]",children:"시나리오 \xb7 이미지 \xb7 영상 \xb7 음성 통합 제작"})]})]}),(0,a.jsx)("button",{onClick:()=>u(e=>!e),className:"text-xs px-3 py-1.5 rounded border border-[var(--border)] text-[var(--text-muted)] hover:text-white hover:border-[var(--accent)] transition-colors",children:x?"▲ API Keys 숨기기":"▼ API Keys 설정"})]}),x&&(0,a.jsxs)("div",{className:"px-6 py-4 border-b border-[var(--border)]",style:{background:"var(--surface-2)"},children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 max-w-4xl",children:[(0,a.jsx)(S,{label:"OpenAI (기획\xb7이미지\xb7음성)",value:i.openai,onChange:e=>es("openai",e)}),(0,a.jsx)(S,{label:"Replicate (이미지)",value:i.replicate,onChange:e=>es("replicate",e),placeholder:"r8_..."}),(0,a.jsx)(S,{label:"FAL AI (이미지\xb7영상)",value:i.fal,onChange:e=>es("fal",e),placeholder:"fal-..."}),(0,a.jsx)(S,{label:"ElevenLabs (음성)",value:i.elevenlabs,onChange:e=>es("elevenlabs",e),placeholder:"el_..."})]}),(0,a.jsx)("p",{className:"text-xs text-[var(--text-muted)] mt-2",children:"\uD83D\uDD10 키는 브라우저 로컬 스토리지에만 저장됩니다. 서버로 전송되지 않습니다."})]}),(0,a.jsx)("nav",{className:"flex border-b border-[var(--border)]",style:{background:"var(--surface)"},children:N.map(e=>(0,a.jsxs)("button",{onClick:()=>o(e.id),className:"flex items-center gap-1.5 px-5 py-3 text-sm font-medium transition-colors\n              border-b-2 ".concat(r===e.id?"border-[var(--accent)] text-white":"border-transparent text-[var(--text-muted)] hover:text-white"),children:[(0,a.jsx)("span",{children:e.icon}),(0,a.jsx)("span",{children:e.label}),"scenario"===e.id&&L&&(0,a.jsx)("span",{className:"ml-1 text-xs bg-[var(--accent-20)] text-[var(--accent)] px-1.5 rounded-full",children:L.scenes.length})]},e.id))}),(0,a.jsxs)("main",{className:"flex-1 overflow-y-auto p-6",children:["plan"===r&&(0,a.jsxs)("div",{className:"max-w-3xl mx-auto space-y-6",children:[(0,a.jsx)(C,{children:"프로젝트 기획"}),(0,a.jsxs)("div",{className:"p-5 rounded-xl border border-[var(--border)]",style:{background:"var(--surface)"},children:[(0,a.jsx)("h3",{className:"text-sm font-semibold text-white mb-4",children:"기본 정보"}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-xs text-[var(--text-muted)] mb-1 block",children:"프로젝트 아이디어 *"}),(0,a.jsx)("textarea",{rows:3,value:m.concept,onChange:e=>p(t=>({...t,concept:e.target.value})),placeholder:"예: 치아 캐릭터 '치치'가 양치질의 중요성을 알려주는 3D 클레이 애니메이션",className:"w-full px-3 py-2 rounded border border-[var(--border)] text-sm resize-none"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-xs text-[var(--text-muted)] mb-1 block",children:"장르"}),(0,a.jsx)("input",{value:m.genre,onChange:e=>p(t=>({...t,genre:e.target.value})),placeholder:"animation, documentary, ad...",className:"w-full px-3 py-2 rounded border border-[var(--border)] text-sm"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-xs text-[var(--text-muted)] mb-1 block",children:"대상"}),(0,a.jsx)("input",{value:m.targetAudience,onChange:e=>p(t=>({...t,targetAudience:e.target.value})),placeholder:"어린이, 직장인...",className:"w-full px-3 py-2 rounded border border-[var(--border)] text-sm"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-xs text-[var(--text-muted)] mb-1 block",children:"톤/분위기"}),(0,a.jsx)("input",{value:m.tone,onChange:e=>p(t=>({...t,tone:e.target.value})),placeholder:"유쾌하고 따뜻한",className:"w-full px-3 py-2 rounded border border-[var(--border)] text-sm"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-xs text-[var(--text-muted)] mb-1 block",children:"비주얼 스타일"}),(0,a.jsx)("input",{value:m.styleRef,onChange:e=>p(t=>({...t,styleRef:e.target.value})),placeholder:"3D clay render, Pixar style...",className:"w-full px-3 py-2 rounded border border-[var(--border)] text-sm"})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-xs text-[var(--text-muted)] mb-1 block",children:"씬 수"}),(0,a.jsx)("input",{type:"number",min:1,max:20,value:m.sceneCount,onChange:e=>p(t=>({...t,sceneCount:parseInt(e.target.value)||5})),className:"w-full px-3 py-2 rounded border border-[var(--border)] text-sm"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-xs text-[var(--text-muted)] mb-1 block",children:"대사 언어"}),(0,a.jsxs)("select",{value:m.language,onChange:e=>p(t=>({...t,language:e.target.value})),className:"w-full px-3 py-2 rounded border border-[var(--border)] text-sm",children:[(0,a.jsx)("option",{value:"ko",children:"한국어"}),(0,a.jsx)("option",{value:"en",children:"English"}),(0,a.jsx)("option",{value:"ja",children:"日本語"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-xs text-[var(--text-muted)] mb-1 block",children:"AI 모델"}),(0,a.jsxs)("select",{value:b,onChange:e=>j(e.target.value),className:"w-full px-3 py-2 rounded border border-[var(--border)] text-sm",children:[(0,a.jsx)("option",{value:"gpt-4o",children:"GPT-4o (고품질)"}),(0,a.jsx)("option",{value:"gpt-4o-mini",children:"GPT-4o mini (빠름)"})]})]})]})]})]}),(0,a.jsxs)("div",{className:"p-5 rounded-xl border border-[var(--border)]",style:{background:"var(--surface)"},children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsx)("h3",{className:"text-sm font-semibold text-white",children:"캐릭터"}),(0,a.jsx)("button",{onClick:function(){p(e=>({...e,characters:[...e.characters,{...w}]}))},className:"text-xs px-3 py-1 rounded border border-[var(--accent)] text-[var(--accent)] hover:bg-[var(--accent-10)]",children:"+ 캐릭터 추가"})]}),(0,a.jsx)("div",{className:"space-y-3",children:m.characters.map((e,t)=>(0,a.jsxs)("div",{className:"p-3 rounded-lg border border-[var(--border)]",style:{background:"var(--surface-2)"},children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsxs)("span",{className:"text-xs font-medium text-[var(--accent)]",children:["캐릭터 ",t+1]}),t>0&&(0,a.jsx)("button",{onClick:()=>{p(e=>({...e,characters:e.characters.filter((e,r)=>r!==t)}))},className:"text-xs text-[var(--danger)] hover:underline",children:"삭제"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,a.jsx)("input",{value:e.name,placeholder:"이름",onChange:e=>eo(t,"name",e.target.value),className:"px-2 py-1.5 rounded border border-[var(--border)] text-sm"}),(0,a.jsxs)("select",{value:e.role,onChange:e=>eo(t,"role",e.target.value),className:"px-2 py-1.5 rounded border border-[var(--border)] text-sm",children:[(0,a.jsx)("option",{value:"주인공",children:"주인공"}),(0,a.jsx)("option",{value:"조연",children:"조연"}),(0,a.jsx)("option",{value:"나레이터",children:"나레이터"})]}),(0,a.jsx)("input",{value:e.description,placeholder:"외형 및 성격 설명",onChange:e=>eo(t,"description",e.target.value),className:"col-span-2 px-2 py-1.5 rounded border border-[var(--border)] text-sm"}),(0,a.jsx)("input",{value:e.voiceType,placeholder:"목소리 유형 (밝고 활기찬, 차분한...)",onChange:e=>eo(t,"voiceType",e.target.value),className:"col-span-2 px-2 py-1.5 rounded border border-[var(--border)] text-sm"})]})]},t))})]}),(0,a.jsxs)("div",{className:"p-5 rounded-xl border border-[var(--border)]",style:{background:"var(--surface)"},children:[(0,a.jsx)("h3",{className:"text-sm font-semibold text-white mb-3",children:"절대 금지 사항"}),(0,a.jsxs)("div",{className:"space-y-2",children:[m.constraints.map((e,t)=>(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("input",{value:e,placeholder:"예: 폭력적인 장면, 특정 브랜드 로고...",onChange:e=>{let r=[...m.constraints];r[t]=e.target.value,p(e=>({...e,constraints:r}))},className:"flex-1 px-2 py-1.5 rounded border border-[var(--border)] text-sm"}),(0,a.jsx)("button",{onClick:()=>p(e=>({...e,constraints:e.constraints.filter((e,r)=>r!==t)})),className:"text-[var(--danger)] px-2 text-lg",children:"\xd7"})]},t)),(0,a.jsx)("button",{onClick:()=>p(e=>({...e,constraints:[...e.constraints,""]})),className:"text-xs text-[var(--text-muted)] hover:text-white",children:"+ 금지 사항 추가"})]})]}),(0,a.jsxs)("div",{className:"p-5 rounded-xl border border-[var(--border)]",style:{background:"var(--surface)"},children:[(0,a.jsx)("label",{className:"text-sm font-semibold text-white mb-2 block",children:"추가 지시사항"}),(0,a.jsx)("textarea",{rows:2,value:m.additionalNotes,onChange:e=>p(t=>({...t,additionalNotes:e.target.value})),placeholder:"기타 특별한 요청사항을 자유롭게 입력해주세요.",className:"w-full px-3 py-2 rounded border border-[var(--border)] text-sm resize-none"})]}),(0,a.jsx)("button",{onClick:el,disabled:y,className:"w-full py-3.5 rounded-xl font-bold text-white text-sm transition-all disabled:opacity-50 disabled:cursor-not-allowed",style:{background:y?"var(--surface-2)":"var(--accent)"},children:y?"✦ AI가 기획 중... (스트리밍)":"✦ AI로 전체 기획 생성하기"}),O&&(0,a.jsx)("div",{className:"p-3 rounded-lg text-sm text-[var(--danger)] border border-[var(--danger-30)]",style:{background:"var(--surface)"},children:O}),y&&I&&(0,a.jsxs)("div",{className:"p-4 rounded-xl border border-[var(--border)] font-mono text-xs text-[var(--text-muted)] max-h-64 overflow-y-auto",style:{background:"var(--surface)"},children:[(0,a.jsx)("div",{className:"text-[var(--accent)] mb-2 text-xs font-sans font-semibold",children:"AI 응답 스트리밍 중..."}),(0,a.jsx)("pre",{className:"whitespace-pre-wrap break-all streaming-cursor",children:I})]}),L&&!y&&(0,a.jsxs)("div",{className:"p-4 rounded-xl border border-[var(--success-30)]",style:{background:"var(--surface)"},children:[(0,a.jsxs)("p",{className:"text-[var(--success)] text-sm font-semibold",children:["✓ 기획 완성! — ",L.project.title]}),(0,a.jsx)("p",{className:"text-xs text-[var(--text-muted)] mt-1",children:L.project.logline}),(0,a.jsxs)("p",{className:"text-xs text-[var(--text-muted)] mt-1",children:["씬 ",L.scenes.length,"개 \xb7 캐릭터 ",L.characters.length,"명"]}),(0,a.jsx)("button",{onClick:()=>o("scenario"),className:"mt-2 text-xs text-[var(--accent)] hover:underline",children:"시나리오 탭으로 이동 →"})]})]}),"scenario"===r&&(0,a.jsx)("div",{className:"max-w-3xl mx-auto space-y-6",children:L?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"p-5 rounded-xl border border-[var(--border)]",style:{background:"var(--surface)"},children:[(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-lg font-bold text-white",children:L.project.title}),(0,a.jsx)("p",{className:"text-sm text-[var(--text-muted)] mt-1",children:L.project.logline})]}),(0,a.jsx)("span",{className:"text-xs px-2 py-1 rounded bg-[var(--accent-20)] text-[var(--accent)]",children:L.project.genre})]}),(0,a.jsxs)("div",{className:"mt-3 grid grid-cols-3 gap-3 text-xs",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-[var(--text-muted)]",children:"대상: "}),L.project.targetAudience]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-[var(--text-muted)]",children:"분위기: "}),L.project.tone]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-[var(--text-muted)]",children:"길이: "}),L.project.totalDuration]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(C,{children:"캐릭터"}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:L.characters.map(e=>{var t,r;return(0,a.jsxs)("div",{className:"p-4 rounded-xl border border-[var(--border)]",style:{background:"var(--surface)"},children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsx)("span",{className:"font-semibold text-white text-sm",children:e.name}),(0,a.jsx)("span",{className:"text-xs text-[var(--text-muted)]",children:e.role})]}),(0,a.jsx)("p",{className:"text-xs text-[var(--text-muted)] mb-2",children:e.personality}),(0,a.jsxs)("div",{className:"flex items-center gap-2 text-xs",children:[(0,a.jsxs)("span",{className:"px-2 py-0.5 rounded-full bg-[var(--surface-2)] border border-[var(--border)]",children:["\uD83C\uDF99 ",null!=(r=null==(t=g[e.voice.suggestedTTSVoice])?void 0:t.label)?r:e.voice.suggestedTTSVoice]}),(0,a.jsx)("span",{className:"text-[var(--text-muted)]",children:e.voice.tone})]})]},e.id)})})]}),(0,a.jsxs)("div",{className:"p-5 rounded-xl border border-[var(--border)]",style:{background:"var(--surface)"},children:[(0,a.jsx)(C,{children:"스토리 개요"}),(0,a.jsx)("p",{className:"text-sm text-[var(--text-muted)] leading-relaxed",children:L.scenario.outline})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(C,{children:"씬 목록"}),(0,a.jsx)("div",{className:"space-y-4",children:L.scenes.map((e,t)=>(0,a.jsxs)("div",{className:"p-5 rounded-xl border border-[var(--border)]",style:{background:"var(--surface)"},children:[(0,a.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("span",{className:"text-xs text-[var(--accent)] font-mono",children:["ACT ",e.act," \xb7 SCENE ",e.order]}),(0,a.jsx)("h3",{className:"font-semibold text-white text-sm mt-0.5",children:e.title}),(0,a.jsxs)("p",{className:"text-xs text-[var(--text-muted)]",children:[e.setting," \xb7 ",e.durationSeconds,"초 \xb7 ",e.mood]})]}),(0,a.jsx)("div",{className:"flex gap-1",children:e.generatedImageUrl&&(0,a.jsx)(A,{status:"completed"})})]}),(0,a.jsx)("p",{className:"text-sm text-[var(--text-muted)] mb-3",children:e.description}),e.narration&&(0,a.jsxs)("div",{className:"mb-3 p-3 rounded-lg border border-[var(--border)]",style:{background:"var(--surface-2)"},children:[(0,a.jsx)("span",{className:"text-xs font-semibold text-[var(--accent-2)]",children:"나레이션"}),(0,a.jsx)("textarea",{rows:2,value:e.narration,onChange:t=>{let r=t.target.value;en(t=>t.map(t=>t.id===e.id?{...t,narration:r}:t))},className:"w-full mt-1 px-2 py-1 text-xs rounded border border-[var(--border)] resize-none"})]}),e.dialogues.length>0&&(0,a.jsx)("div",{className:"space-y-2",children:e.dialogues.map((t,r)=>(0,a.jsxs)("div",{className:"flex gap-2 items-start p-2 rounded-lg",style:{background:"var(--surface-2)"},children:[(0,a.jsx)("span",{className:"text-xs font-medium text-[var(--accent)] whitespace-nowrap mt-1",children:t.characterName}),(0,a.jsx)("textarea",{rows:1,value:t.line,onChange:t=>{let a=t.target.value;en(t=>t.map(t=>{if(t.id!==e.id)return t;let n=t.dialogues.map((e,t)=>t===r?{...e,line:a}:e);return{...t,dialogues:n}}))},className:"flex-1 px-2 py-1 text-xs rounded border border-[var(--border)] resize-none"}),(0,a.jsx)("span",{className:"text-xs text-[var(--text-muted)] whitespace-nowrap mt-1",children:t.emotion})]},r))})]},e.id))})]})]}):(0,a.jsx)("div",{className:"text-center py-20 text-[var(--text-muted)]",children:"기획 탭에서 먼저 AI 기획을 생성해주세요."})}),"image"===r&&(0,a.jsx)("div",{className:"max-w-4xl mx-auto space-y-6",children:L?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"p-5 rounded-xl border border-[var(--border)]",style:{background:"var(--surface)"},children:[(0,a.jsx)(C,{children:"이미지 생성 설정"}),(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-xs text-[var(--text-muted)] mb-1 block",children:"공급자"}),(0,a.jsxs)("select",{value:_,onChange:e=>{var t;D(t=e.target.value),F(K[t])},className:"w-full px-3 py-2 rounded border border-[var(--border)] text-sm",children:[(0,a.jsx)("option",{value:"replicate",children:"Replicate (Flux)"}),(0,a.jsx)("option",{value:"fal",children:"FAL AI"}),(0,a.jsx)("option",{value:"openai",children:"OpenAI"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-xs text-[var(--text-muted)] mb-1 block",children:"모델"}),(0,a.jsxs)("select",{value:R,onChange:e=>F(e.target.value),className:"w-full px-3 py-2 rounded border border-[var(--border)] text-sm",children:["replicate"===_&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("option",{value:"flux-kontext-pro",children:"Flux Kontext Pro (~$0.04)"}),(0,a.jsx)("option",{value:"flux-1.1-pro",children:"Flux 1.1 Pro (~$0.04)"}),(0,a.jsx)("option",{value:"flux-dev",children:"Flux Dev (~$0.003)"})]}),"fal"===_&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("option",{value:"fal-flux-kontext",children:"FAL Flux Kontext (~$0.05)"}),(0,a.jsx)("option",{value:"fal-flux-pro",children:"FAL Flux Pro"})]}),"openai"===_&&(0,a.jsx)(a.Fragment,{children:(0,a.jsx)("option",{value:"gpt-image-1",children:"GPT Image-1 (~$0.17)"})})]})]}),(0,a.jsx)("div",{className:"flex items-end",children:(0,a.jsx)("button",{onClick:ec,className:"w-full py-2 rounded border border-[var(--accent)] text-[var(--accent)] text-sm hover:bg-[var(--accent-10)] transition-colors",children:"전체 씬 이미지 생성"})})]}),(0,a.jsxs)("p",{className:"text-xs text-[var(--text-muted)] mt-2",children:["완료: ",em,"/",L.scenes.length," 씬"]})]}),(0,a.jsx)("div",{className:"space-y-4",children:L.scenes.map(e=>{var t;return(0,a.jsx)("div",{className:"p-5 rounded-xl border border-[var(--border)]",style:{background:"var(--surface)"},children:(0,a.jsxs)("div",{className:"flex items-start gap-4",children:[(0,a.jsx)("div",{className:"w-40 h-28 rounded-lg border border-[var(--border)] flex-shrink-0 overflow-hidden flex items-center justify-center",style:{background:"var(--surface-2)"},children:e.generatedImageUrl?(0,a.jsx)("img",{src:e.generatedImageUrl,alt:e.title,className:"w-full h-full object-cover"}):(0,a.jsx)("span",{className:"text-3xl opacity-20",children:"◧"})}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsxs)("h3",{className:"text-sm font-semibold text-white",children:["Scene ",e.order,": ",e.title]}),(0,a.jsx)(A,{status:null!=(t=q[e.id])?t:"idle",error:z[e.id]})]}),(0,a.jsxs)("div",{className:"mb-2",children:[(0,a.jsx)("label",{className:"text-xs text-[var(--text-muted)]",children:"이미지 프롬프트"}),(0,a.jsx)("textarea",{rows:3,value:e.imagePrompt.full||e.imagePrompt.main,onChange:t=>{let r=t.target.value;en(t=>t.map(t=>t.id===e.id?{...t,imagePrompt:{...t.imagePrompt,full:r}}:t))},className:"w-full mt-1 px-2 py-1.5 text-xs rounded border border-[var(--border)] resize-none font-mono"})]}),(0,a.jsxs)("div",{className:"mb-3",children:[(0,a.jsx)("label",{className:"text-xs text-[var(--text-muted)]",children:"네거티브"}),(0,a.jsx)("input",{value:e.imagePrompt.negative,onChange:t=>{let r=t.target.value;en(t=>t.map(t=>t.id===e.id?{...t,imagePrompt:{...t.imagePrompt,negative:r}}:t))},className:"w-full mt-1 px-2 py-1.5 text-xs rounded border border-[var(--border)] font-mono"})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("button",{onClick:()=>ei(e),disabled:"running"===q[e.id],className:"px-4 py-1.5 rounded text-xs font-medium text-white disabled:opacity-50 transition-colors",style:{background:"var(--accent)"},children:"running"===q[e.id]?"생성 중...":"이미지 생성"}),e.generatedImageUrl&&(0,a.jsx)("a",{href:e.generatedImageUrl,target:"_blank",rel:"noreferrer",className:"px-3 py-1.5 rounded text-xs border border-[var(--border)] text-[var(--text-muted)] hover:text-white",children:"원본 보기"})]}),z[e.id]&&(0,a.jsx)("p",{className:"text-xs text-[var(--danger)] mt-1",children:z[e.id]})]})]})},e.id)})})]}):(0,a.jsx)("div",{className:"text-center py-20 text-[var(--text-muted)]",children:"기획 탭에서 먼저 AI 기획을 생성해주세요."})}),"video"===r&&(0,a.jsx)("div",{className:"max-w-4xl mx-auto space-y-6",children:L?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"p-5 rounded-xl border border-[var(--border)]",style:{background:"var(--surface)"},children:[(0,a.jsx)(C,{children:"영상 생성 설정 (FAL AI)"}),(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-xs text-[var(--text-muted)] mb-1 block",children:"모델"}),(0,a.jsx)("select",{value:J,onChange:e=>B(e.target.value),className:"w-full px-3 py-2 rounded border border-[var(--border)] text-sm",children:Object.entries(h).map(e=>{let[t,r]=e;return(0,a.jsxs)("option",{value:t,children:[r.label," \xb7 ",r.price," ",r.note?"\xb7 ".concat(r.note):""]},t)})})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-xs text-[var(--text-muted)] mb-1 block",children:"길이 (초)"}),(0,a.jsxs)("select",{value:$,onChange:e=>G(Number(e.target.value)),className:"w-full px-3 py-2 rounded border border-[var(--border)] text-sm",children:[(0,a.jsx)("option",{value:5,children:"5초"}),(0,a.jsx)("option",{value:6,children:"6초"}),(0,a.jsx)("option",{value:8,children:"8초"}),(0,a.jsx)("option",{value:10,children:"10초"})]})]}),(0,a.jsx)("div",{className:"flex items-end",children:(0,a.jsxs)("p",{className:"text-xs text-[var(--text-muted)]",children:["완료: ",ep,"/",L.scenes.length," \xb7 이미지 먼저 생성 필요"]})})]})]}),(0,a.jsx)("div",{className:"space-y-4",children:L.scenes.map(e=>{var t;return(0,a.jsx)("div",{className:"p-5 rounded-xl border border-[var(--border)]",style:{background:"var(--surface)"},children:(0,a.jsxs)("div",{className:"flex gap-4",children:[(0,a.jsx)("div",{className:"w-32 flex-shrink-0",children:e.generatedVideoUrl?(0,a.jsx)("video",{src:e.generatedVideoUrl,controls:!0,className:"w-full rounded-lg border border-[var(--border)]"}):e.generatedImageUrl?(0,a.jsx)("img",{src:e.generatedImageUrl,alt:"",className:"w-full h-20 object-cover rounded-lg border border-[var(--border)] opacity-60"}):(0,a.jsx)("div",{className:"w-full h-20 rounded-lg border border-[var(--border)] flex items-center justify-center",style:{background:"var(--surface-2)"},children:(0,a.jsx)("span",{className:"text-2xl opacity-20",children:"▶"})})}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsxs)("h3",{className:"text-sm font-semibold text-white",children:["Scene ",e.order,": ",e.title]}),(0,a.jsx)(A,{status:null!=(t=W[e.id])?t:"idle",error:H[e.id]})]}),(0,a.jsxs)("div",{className:"mb-3",children:[(0,a.jsx)("label",{className:"text-xs text-[var(--text-muted)]",children:"영상 프롬프트"}),(0,a.jsx)("textarea",{rows:3,value:e.videoPrompt.full||e.videoPrompt.motion,onChange:t=>{let r=t.target.value;en(t=>t.map(t=>t.id===e.id?{...t,videoPrompt:{...t.videoPrompt,full:r}}:t))},className:"w-full mt-1 px-2 py-1.5 text-xs rounded border border-[var(--border)] resize-none font-mono"})]}),(0,a.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,a.jsx)("button",{onClick:()=>ed(e),disabled:"running"===W[e.id]||!e.generatedImageUrl,className:"px-4 py-1.5 rounded text-xs font-medium text-white disabled:opacity-40 transition-colors",style:{background:"var(--accent-2)"},children:"running"===W[e.id]?"생성 중... (최대 7분)":"영상 생성"}),!e.generatedImageUrl&&(0,a.jsx)("span",{className:"text-xs text-[var(--warning)]",children:"⚠ 이미지 필요"}),H[e.id]&&(0,a.jsx)("span",{className:"text-xs text-[var(--danger)]",children:H[e.id]})]})]})]})},e.id)})})]}):(0,a.jsx)("div",{className:"text-center py-20 text-[var(--text-muted)]",children:"기획 탭에서 먼저 AI 기획을 생성해주세요."})}),"voice"===r&&(0,a.jsx)("div",{className:"max-w-3xl mx-auto space-y-6",children:L?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"p-5 rounded-xl border border-[var(--border)]",style:{background:"var(--surface)"},children:[(0,a.jsx)(C,{children:"음성 생성 설정"}),(0,a.jsx)("div",{className:"flex gap-3",children:["openai","elevenlabs"].map(e=>(0,a.jsx)("button",{onClick:()=>Z(e),className:"px-4 py-2 rounded-lg text-sm font-medium border transition-colors\n                          ".concat(Q===e?"border-[var(--accent)] text-white bg-[var(--accent-20)]":"border-[var(--border)] text-[var(--text-muted)] hover:text-white"),children:"openai"===e?"OpenAI TTS":"ElevenLabs"},e))}),(0,a.jsxs)("div",{className:"mt-4",children:[(0,a.jsx)("p",{className:"text-xs text-[var(--text-muted)] mb-2",children:"캐릭터 음성 배정"}),(0,a.jsx)("div",{className:"space-y-2",children:L.characters.map(e=>{var t,r;return(0,a.jsxs)("div",{className:"flex items-center gap-3 text-xs",children:[(0,a.jsx)("span",{className:"w-24 text-white truncate",children:e.name}),(0,a.jsx)("span",{className:"px-2 py-0.5 rounded bg-[var(--surface-2)] border border-[var(--border)]",children:null!=(r=null==(t=g[e.voice.suggestedTTSVoice])?void 0:t.label)?r:e.voice.suggestedTTSVoice}),(0,a.jsx)("span",{className:"text-[var(--text-muted)]",children:e.voice.tone})]},e.id)})})]})]}),(0,a.jsx)("div",{className:"space-y-4",children:L.scenes.map(e=>{var t;return(0,a.jsxs)("div",{className:"p-5 rounded-xl border border-[var(--border)]",style:{background:"var(--surface)"},children:[(0,a.jsxs)("h3",{className:"text-sm font-semibold text-white mb-3",children:["Scene ",e.order,": ",e.title]}),e.narration&&(0,a.jsxs)("div",{className:"mb-4 p-3 rounded-lg border border-[var(--border)]",style:{background:"var(--surface-2)"},children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsx)("span",{className:"text-xs font-semibold text-[var(--accent-2)]",children:"나레이션"}),(0,a.jsx)(A,{status:null!=(t=ee[e.id])?t:"idle"})]}),(0,a.jsx)("p",{className:"text-xs text-[var(--text-muted)] mb-2",children:e.narration}),e.generatedNarrationUrl&&(0,a.jsx)("audio",{src:e.generatedNarrationUrl,controls:!0,className:"w-full h-8 mb-2"}),(0,a.jsx)("button",{onClick:()=>ex(e),disabled:"running"===ee[e.id],className:"px-3 py-1 rounded text-xs border border-[var(--accent-2)] text-[var(--accent-2)] hover:bg-[var(--accent-2-10)] disabled:opacity-50",children:"running"===ee[e.id]?"생성 중...":"나레이션 생성"})]}),e.dialogues.map((t,r)=>{var n;let s="".concat(e.id,"_").concat(r);return(0,a.jsxs)("div",{className:"mb-3 p-3 rounded-lg border border-[var(--border)]",style:{background:"var(--surface-2)"},children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,a.jsx)("span",{className:"text-xs font-semibold text-[var(--accent)]",children:t.characterName}),(0,a.jsx)(A,{status:null!=(n=er[s])?n:"idle"})]}),(0,a.jsxs)("p",{className:"text-xs text-[var(--text-muted)] mb-2",children:['"',t.line,'" ',(0,a.jsxs)("em",{className:"opacity-60",children:["(",t.emotion,")"]})]}),t.audioUrl&&(0,a.jsx)("audio",{src:t.audioUrl,controls:!0,className:"w-full h-8 mb-2"}),(0,a.jsx)("button",{onClick:()=>eu(e,r),disabled:"running"===er[s],className:"px-3 py-1 rounded text-xs border border-[var(--border)] text-[var(--text-muted)] hover:text-white hover:border-[var(--accent)] disabled:opacity-50",children:"running"===er[s]?"생성 중...":"대사 음성 생성"})]},r)})]},e.id)})})]}):(0,a.jsx)("div",{className:"text-center py-20 text-[var(--text-muted)]",children:"기획 탭에서 먼저 AI 기획을 생성해주세요."})}),"export"===r&&(0,a.jsx)("div",{className:"max-w-3xl mx-auto space-y-6",children:L?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(C,{children:"내보내기"}),(0,a.jsxs)("div",{className:"p-5 rounded-xl border border-[var(--border)]",style:{background:"var(--surface)"},children:[(0,a.jsx)("h3",{className:"text-sm font-bold text-white mb-4",children:L.project.title}),(0,a.jsx)("div",{className:"grid grid-cols-4 gap-4 text-center mb-4",children:[{label:"총 씬",value:L.scenes.length},{label:"이미지 완료",value:em},{label:"영상 완료",value:ep},{label:"캐릭터",value:L.characters.length}].map(e=>{let{label:t,value:r}=e;return(0,a.jsxs)("div",{className:"p-3 rounded-lg border border-[var(--border)]",style:{background:"var(--surface-2)"},children:[(0,a.jsx)("div",{className:"text-xl font-bold text-white",children:r}),(0,a.jsx)("div",{className:"text-xs text-[var(--text-muted)] mt-1",children:t})]},t)})}),(0,a.jsxs)("div",{className:"text-xs space-y-1",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-[var(--text-muted)]",children:"색상 팔레트: "}),L.productionNotes.colorPalette.join(" \xb7 ")]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-[var(--text-muted)]",children:"조명: "}),L.productionNotes.lightingStyle]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-[var(--text-muted)]",children:"음악: "}),L.productionNotes.musicMood]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-[var(--text-muted)]",children:"편집: "}),L.productionNotes.editingStyle]})]})]}),(0,a.jsxs)("div",{className:"p-5 rounded-xl border border-[var(--border)]",style:{background:"var(--surface)"},children:[(0,a.jsx)("h3",{className:"text-sm font-semibold text-white mb-4",children:"씬별 에셋"}),(0,a.jsx)("div",{className:"space-y-3",children:L.scenes.map(e=>(0,a.jsxs)("div",{className:"flex items-center gap-3 py-2 border-b border-[var(--border)] last:border-0",children:[e.generatedImageUrl?(0,a.jsx)("img",{src:e.generatedImageUrl,alt:"",className:"w-12 h-8 object-cover rounded border border-[var(--border)]"}):(0,a.jsx)("div",{className:"w-12 h-8 rounded border border-[var(--border)] flex items-center justify-center",style:{background:"var(--surface-2)"},children:(0,a.jsx)("span",{className:"text-xs opacity-30",children:"-"})}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("p",{className:"text-xs font-medium text-white",children:["Scene ",e.order,": ",e.title]}),(0,a.jsx)("p",{className:"text-xs text-[var(--text-muted)]",children:e.setting})]}),(0,a.jsxs)("div",{className:"flex gap-1.5",children:[e.generatedImageUrl?(0,a.jsx)("a",{href:e.generatedImageUrl,download:"scene_".concat(e.order,"_image.png"),target:"_blank",rel:"noreferrer",className:"text-xs px-2 py-0.5 rounded border border-[var(--success-40)] text-[var(--success)] hover:bg-[var(--success-10)]",children:"이미지"}):(0,a.jsx)("span",{className:"text-xs text-[var(--text-muted)] px-2",children:"이미지 없음"}),e.generatedVideoUrl?(0,a.jsx)("a",{href:e.generatedVideoUrl,download:"scene_".concat(e.order,"_video.mp4"),target:"_blank",rel:"noreferrer",className:"text-xs px-2 py-0.5 rounded border border-[var(--accent-2-40)] text-[var(--accent-2)] hover:bg-[var(--accent-2-10)]",children:"영상"}):(0,a.jsx)("span",{className:"text-xs text-[var(--text-muted)] px-2",children:"영상 없음"})]})]},e.id))})]}),(0,a.jsxs)("div",{className:"p-5 rounded-xl border border-[var(--border)]",style:{background:"var(--surface)"},children:[(0,a.jsx)("h3",{className:"text-sm font-semibold text-white mb-3",children:"전체 기획 JSON 내보내기"}),(0,a.jsx)("p",{className:"text-xs text-[var(--text-muted)] mb-3",children:"생성된 전체 기획 데이터를 JSON 파일로 저장합니다. 나중에 다시 불러올 수 있습니다."}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("button",{onClick:()=>{let e=new Blob([JSON.stringify(L,null,2)],{type:"application/json"}),t=URL.createObjectURL(e),r=document.createElement("a");r.href=t,r.download="".concat(L.project.title.replace(/\s+/g,"_"),"_plan.json"),r.click(),URL.revokeObjectURL(t)},className:"px-4 py-2 rounded text-sm font-medium text-white transition-colors",style:{background:"var(--accent)"},children:"JSON 다운로드"}),(0,a.jsx)("button",{onClick:()=>{let e=["# ".concat(L.project.title),"## ".concat(L.project.logline),"","**장르:** ".concat(L.project.genre," | **대상:** ").concat(L.project.targetAudience," | **길이:** ").concat(L.project.totalDuration),"","---","","## 시나리오 개요",L.scenario.outline,"","---","","## 씬 스크립트",""];L.scenes.forEach(t=>{e.push("### Scene ".concat(t.order,": ").concat(t.title)),e.push("**배경:** ".concat(t.setting," | **분위기:** ").concat(t.mood," | **").concat(t.durationSeconds,"초**")),e.push(""),e.push(t.description),e.push(""),t.narration&&(e.push("> **나레이션:** ".concat(t.narration)),e.push("")),t.dialogues.forEach(t=>{e.push("**".concat(t.characterName,"** _(").concat(t.emotion,')_: "').concat(t.line,'"'))}),e.push("")});let t=new Blob([e.join("\n")],{type:"text/markdown"}),r=URL.createObjectURL(t),a=document.createElement("a");a.href=r,a.download="".concat(L.project.title.replace(/\s+/g,"_"),"_script.md"),a.click(),URL.revokeObjectURL(r)},className:"px-4 py-2 rounded text-sm font-medium border border-[var(--border)] text-[var(--text-muted)] hover:text-white hover:border-[var(--accent-2)] transition-colors",children:"스크립트 MD 다운로드"})]})]}),(0,a.jsxs)("div",{className:"p-5 rounded-xl border border-[var(--border)]",style:{background:"var(--surface)"},children:[(0,a.jsx)("h3",{className:"text-sm font-semibold text-white mb-3",children:"전역 제약 조건"}),(0,a.jsx)("ul",{className:"space-y-1",children:L.globalConstraints.map((e,t)=>(0,a.jsxs)("li",{className:"text-xs text-[var(--text-muted)] flex gap-2",children:[(0,a.jsx)("span",{className:"text-[var(--danger)]",children:"✕"}),e]},t))})]})]}):(0,a.jsx)("div",{className:"text-center py-20 text-[var(--text-muted)]",children:"기획 탭에서 먼저 AI 기획을 생성해주세요."})})]})]})}}},e=>{e.O(0,[441,255,358],()=>e(e.s=2530)),_N_E=e.O()}]);